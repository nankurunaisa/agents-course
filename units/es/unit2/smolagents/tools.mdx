<CourseFloatingBanner chapter={2}
  classNames="absolute z-10 right-0 top-0"
  notebooks={[
    {label: "Google Colab", value: "https://colab.research.google.com/github/huggingface/agents-course/blob/main/notebooks/unit2/smolagents/tools.ipynb"},
]} />

# Herramientas  

Como exploramos en la [unidad 1](https://huggingface.co/learn/agents-course/unit1/tools), los agentes utilizan herramientas para realizar diversas acciones. En `smolagents`, las herramientas son tratadas como **funciones que un LLM puede llamar dentro de un sistema de agentes**.

Para interactuar con una herramienta, el LLM necesita una **descripci√≥n de la interfaz** con estos componentes clave:  

- **Nombre**: C√≥mo se llama la herramienta
- **Descripci√≥n de la herramienta**: Qu√© hace la herramienta  
- **Tipos de entrada y descripciones**: Qu√© argumentos acepta la herramienta
- **Tipo de salida**: Qu√© devuelve la herramienta

Por ejemplo, mientras prepara una fiesta en la Mansi√≥n Wayne, Alfred necesita varias herramientas para recopilar informaci√≥n - desde buscar servicios de catering hasta encontrar ideas para temas de fiesta. As√≠ es como podr√≠a verse la interfaz de una herramienta de b√∫squeda simple:

- **Nombre:** `web_search`
- **Descripci√≥n de la herramienta:** Busca en la web consultas espec√≠ficas
- **Entrada:** `query` (cadena) - El t√©rmino de b√∫squeda a consultar
- **Salida:** Cadena que contiene los resultados de la b√∫squeda

Al utilizar estas herramientas, Alfred puede tomar decisiones informadas y recopilar toda la informaci√≥n necesaria para planificar la fiesta perfecta.

A continuaci√≥n, puedes ver una animaci√≥n que ilustra c√≥mo se gestiona una llamada a una herramienta:

![Pipeline de agente de https://huggingface.co/docs/smolagents/conceptual_guides/react](https://huggingface.co/datasets/huggingface/documentation-images/resolve/main/transformers/Agent_ManimCE.gif)

## M√©todos de Creaci√≥n de Herramientas

En `smolagents`, las herramientas pueden definirse de dos maneras:  
1. **Usando el decorador `@tool`** para herramientas simples basadas en funciones
2. **Creando una subclase de `Tool`** para funcionalidades m√°s complejas    

### El Decorador `@tool`  

El decorador `@tool` es **la forma recomendada para definir herramientas simples**. Internamente, smolagents analizar√° la informaci√≥n b√°sica sobre la funci√≥n desde Python. Por lo tanto, si nombras tu funci√≥n claramente y escribes un buen docstring, ser√° m√°s f√°cil para el LLM utilizarla.

Usando este enfoque, definimos una funci√≥n con:  

- **Un nombre de funci√≥n claro y descriptivo** que ayuda al LLM a entender su prop√≥sito.  
- **Anotaciones de tipo tanto para entradas como para salidas** para garantizar un uso adecuado.  
- **Una descripci√≥n detallada**, que incluye una secci√≥n `Args:` donde cada argumento se describe expl√≠citamente. Estas descripciones proporcionan un contexto valioso para el LLM, por lo que es importante escribirlas cuidadosamente.  

#### Generando una herramienta que recupera el servicio de catering mejor valorado

<img src="https://huggingface.co/datasets/agents-course/course-images/resolve/main/en/unit2/smolagents/alfred-catering.jpg" alt="Alfred Catering"/>

<Tip>
Puedes seguir el c√≥digo en <a href="https://huggingface.co/agents-course/notebooks/blob/main/unit2/smolagents/tools.ipynb" target="_blank">este notebook</a> que puedes ejecutar usando Google Colab.
</Tip>

Imaginemos que Alfred ya ha decidido el men√∫ para la fiesta, pero ahora necesita ayuda para preparar comida para un n√∫mero tan grande de invitados. Para hacerlo, le gustar√≠a contratar un servicio de catering y necesita identificar las opciones mejor valoradas disponibles. Alfred puede aprovechar una herramienta para buscar los mejores servicios de catering en su √°rea.

A continuaci√≥n se muestra un ejemplo de c√≥mo Alfred puede usar el decorador `@tool` para lograrlo:

```python
from smolagents import CodeAgent, InferenceClientModel, tool

# Imaginemos que tenemos una funci√≥n que obtiene los servicios de catering mejor valorados.
@tool
def catering_service_tool(query: str) -> str:
    """
    Esta herramienta devuelve el servicio de catering mejor valorado en Ciudad G√≥tica.
    
    Args:
        query: Un t√©rmino de b√∫squeda para encontrar servicios de catering.
    """
    # Lista de ejemplo de servicios de catering y sus calificaciones
    services = {
        "Gotham Catering Co.": 4.9,
        "Wayne Manor Catering": 4.8,
        "Gotham City Events": 4.7,
    }
    
    # Encuentra el servicio de catering mejor valorado (simulando el filtrado de consultas de b√∫squeda)
    best_service = max(services, key=services.get)
    
    return best_service


agent = CodeAgent(tools=[catering_service_tool], model=InferenceClientModel())

# Ejecuta el agente para encontrar el mejor servicio de catering
result = agent.run(
    "¬øPuedes darme el nombre del servicio de catering mejor valorado en Ciudad G√≥tica?"
)

print(result)   # Salida: Gotham Catering Co.
```

### Definiendo una Herramienta como una Clase de Python  

Este enfoque implica crear una subclase de [`Tool`](https://huggingface.co/docs/smolagents/v1.8.1/en/reference/tools#smolagents.Tool). Para herramientas complejas, podemos implementar una clase en lugar de una funci√≥n de Python. La clase envuelve la funci√≥n con metadatos que ayudan al LLM a entender c√≥mo usarla de manera efectiva. En esta clase, definimos:  

- `name`: El nombre de la herramienta.  
- `description`: Una descripci√≥n utilizada para completar el prompt del sistema del agente.  
- `inputs`: Un diccionario con claves `type` y `description`, proporcionando informaci√≥n para ayudar al int√©rprete de Python a procesar las entradas.  
- `output_type`: Especifica el tipo de salida esperado.  
- `forward`: El m√©todo que contiene la l√≥gica de inferencia a ejecutar.

A continuaci√≥n, podemos ver un ejemplo de una herramienta construida usando `Tool` y c√≥mo integrarla dentro de un `CodeAgent`.

#### Generando una herramienta para generar ideas sobre la fiesta tem√°tica de superh√©roes

La fiesta de Alfred en la mansi√≥n es un **evento tem√°tico de superh√©roes**, pero necesita algunas ideas creativas para hacerla verdaderamente especial. Como anfitri√≥n fant√°stico, quiere sorprender a los invitados con un tema √∫nico.

Para hacer esto, puede usar un agente que genere ideas de fiestas tem√°ticas de superh√©roes basadas en una categor√≠a dada. De esta manera, Alfred puede encontrar el tema de fiesta perfecto para impresionar a sus invitados.

```python
from smolagents import Tool, CodeAgent, InferenceClientModel

class SuperheroPartyThemeTool(Tool):
    name = "superhero_party_theme_generator"
    description = """
    Esta herramienta sugiere ideas creativas para fiestas tem√°ticas de superh√©roes basadas en una categor√≠a.
    Devuelve una idea √∫nica de tema para la fiesta."""
    
    inputs = {
        "category": {
            "type": "string",
            "description": "El tipo de fiesta de superh√©roes (por ejemplo, 'h√©roes cl√°sicos', 'mascarada de villanos', 'Gotham futurista').",
        }
    }
    
    output_type = "string"

    def forward(self, category: str):
        themes = {
            "classic heroes": "Gala de la Liga de la Justicia: Los invitados vienen vestidos como sus h√©roes favoritos de DC con c√≥cteles tem√°ticos como 'El Ponche de Kryptonita'.",
            "villain masquerade": "Baile de los P√≠caros de Gotham: Una mascarada misteriosa donde los invitados se visten como villanos cl√°sicos de Batman.",
            "futuristic Gotham": "Noche Neo-Gotham: Una fiesta de estilo cyberpunk inspirada en Batman Beyond, con decoraciones de ne√≥n y gadgets futuristas."
        }
        
        return themes.get(category.lower(), "Idea de fiesta tem√°tica no encontrada. Prueba con 'h√©roes cl√°sicos', 'mascarada de villanos' o 'Gotham futurista'.")

# Instancia la herramienta
party_theme_tool = SuperheroPartyThemeTool()
agent = CodeAgent(tools=[party_theme_tool], model=InferenceClientModel())

# Ejecuta el agente para generar una idea de tema para la fiesta
result = agent.run(
    "¬øCu√°l ser√≠a una buena idea para una fiesta de superh√©roes con el tema 'mascarada de villanos'?"
)

print(result)  # Salida: "Baile de los P√≠caros de Gotham: Una mascarada misteriosa donde los invitados se visten como villanos cl√°sicos de Batman."
```

Con esta herramienta, ¬°Alfred ser√° el mejor anfitri√≥n, impresionando a sus invitados con una fiesta tem√°tica de superh√©roes que no olvidar√°n! ü¶∏‚Äç‚ôÇÔ∏èü¶∏‚Äç‚ôÄÔ∏è

## Caja de Herramientas Predeterminada  

`smolagents` viene con un conjunto de herramientas preintegradas que pueden inyectarse directamente en tu agente. La [caja de herramientas predeterminada](https://huggingface.co/docs/smolagents/guided_tour?build-a-tool=Decorate+a+function+with+%40tool#default-toolbox) incluye:  

- **PythonInterpreterTool**  
- **FinalAnswerTool**  
- **UserInputTool**  
- **DuckDuckGoSearchTool**  
- **GoogleSearchTool**  
- **VisitWebpageTool**  

Alfred podr√≠a usar varias herramientas para asegurar una fiesta impecable en la Mansi√≥n Wayne:

- Primero, podr√≠a usar la `DuckDuckGoSearchTool` para encontrar ideas creativas para fiestas tem√°ticas de superh√©roes.

- Para el catering, confiar√≠a en la `GoogleSearchTool` para encontrar los servicios mejor valorados en Gotham.

- Para gestionar la distribuci√≥n de asientos, Alfred podr√≠a realizar c√°lculos con la `PythonInterpreterTool`.

- Una vez recopilado todo, compilar√≠a el plan usando la `FinalAnswerTool`.

Con estas herramientas, Alfred garantiza que la fiesta sea excepcional e impecable. ü¶áüí°

## Compartir e Importar Herramientas

Una de las caracter√≠sticas m√°s poderosas de **smolagents** es su capacidad para compartir herramientas personalizadas en el Hub e integrar perfectamente herramientas creadas por la comunidad. Esto incluye la conexi√≥n con **HF Spaces** y **herramientas de LangChain**, mejorando significativamente la capacidad de Alfred para organizar una fiesta inolvidable en la Mansi√≥n Wayne. üé≠

Con estas integraciones, Alfred puede aprovechar herramientas avanzadas de planificaci√≥n de eventos, ya sea ajustar la iluminaci√≥n para el ambiente perfecto, seleccionar la lista de reproducci√≥n ideal para la fiesta, o coordinar con los mejores servicios de catering de Gotham.

Aqu√≠ hay ejemplos que muestran c√≥mo estas funcionalidades pueden elevar la experiencia de la fiesta:

### Compartir una Herramienta en el Hub

¬°Compartir tu herramienta personalizada con la comunidad es f√°cil! Simplemente s√∫bela a tu cuenta de Hugging Face usando el m√©todo `push_to_hub()`.

Por ejemplo, Alfred puede compartir su `party_theme_tool` para ayudar a otros a encontrar los mejores servicios de catering en Gotham. As√≠ es c√≥mo hacerlo:

```python
party_theme_tool.push_to_hub("{tu_nombre_de_usuario}/party_theme_tool", token="<TU_TOKEN_API_HUGGINGFACEHUB>")
```

### Importar una Herramienta desde el Hub

Puedes importar f√°cilmente herramientas creadas por otros usuarios usando la funci√≥n `load_tool()`. Por ejemplo, Alfred podr√≠a querer generar una imagen promocional para la fiesta usando IA. En lugar de construir una herramienta desde cero, puede aprovechar una predefinida de la comunidad:

```python
from smolagents import load_tool, CodeAgent, InferenceClientModel

image_generation_tool = load_tool(
    "m-ric/text-to-image",
    trust_remote_code=True
)

agent = CodeAgent(
    tools=[image_generation_tool],
    model=InferenceClientModel()
)

agent.run("Genera una imagen de una lujosa fiesta tem√°tica de superh√©roes en la Mansi√≥n Wayne con superh√©roes inventados.")
```

### Importar un Hugging Face Space como Herramienta

Tambi√©n puedes importar un HF Space como herramienta usando `Tool.from_space()`. Esto abre posibilidades para integrar miles de spaces de la comunidad para tareas desde generaci√≥n de im√°genes hasta an√°lisis de datos.

La herramienta se conectar√° con el backend Gradio del space usando `gradio_client`, as√≠ que aseg√∫rate de instalarlo via `pip` si a√∫n no lo tienes.

Para la fiesta, Alfred puede usar un HF Space existente para la generaci√≥n de la imagen generada por IA que se usar√° en el anuncio (en lugar de la herramienta preintegrada que mencionamos antes). ¬°Vamos a construirla!

```python
from smolagents import CodeAgent, InferenceClientModel, Tool

image_generation_tool = Tool.from_space(
    "black-forest-labs/FLUX.1-schnell",
    name="image_generator",
    description="Generar una imagen a partir de un prompt"
)

model = InferenceClientModel("Qwen/Qwen2.5-Coder-32B-Instruct")

agent = CodeAgent(tools=[image_generation_tool], model=model)

agent.run(
    "Mejora este prompt, luego genera una imagen del mismo.", 
    additional_args={'user_prompt': 'Una gran fiesta tem√°tica de superh√©roes en la Mansi√≥n Wayne, con Alfred supervisando una lujosa gala'}
)
```

### Importar una Herramienta de LangChain

Discutiremos el framework `LangChain` en las pr√≥ximas secciones. Por ahora, solo notamos que ¬°podemos reutilizar herramientas de LangChain en tu flujo de trabajo de smolagents!

Puedes cargar f√°cilmente herramientas de LangChain usando el m√©todo `Tool.from_langchain()`. Alfred, siempre perfeccionista, est√° preparando una espectacular noche de superh√©roes en la Mansi√≥n Wayne mientras los Wayne est√°n fuera. Para asegurarse de que cada detalle supere las expectativas, aprovecha las herramientas de LangChain para encontrar ideas de entretenimiento de primera categor√≠a.

Al usar `Tool.from_langchain()`, Alfred a√±ade sin esfuerzo funcionalidades de b√∫squeda avanzadas a su smolagent, permiti√©ndole descubrir ideas y servicios exclusivos para fiestas con solo unos pocos comandos.

As√≠ es como lo hace:

```python
from langchain.agents import load_tools
from smolagents import CodeAgent, InferenceClientModel, Tool

search_tool = Tool.from_langchain(load_tools(["serpapi"])[0])

agent = CodeAgent(tools=[search_tool], model=model)

agent.run("Busca ideas de entretenimiento de lujo para un evento tem√°tico de superh√©roes, como actuaciones en vivo y experiencias interactivas.")
```

Con esta configuraci√≥n, Alfred puede descubrir r√°pidamente opciones de entretenimiento lujosas, asegurando que los invitados de √©lite de Gotham tengan una experiencia inolvidable. ¬°Esta herramienta le ayuda a organizar el evento tem√°tico de superh√©roes perfecto para la Mansi√≥n Wayne! üéâ

## Recursos

- [Tutorial de Herramientas](https://huggingface.co/docs/smolagents/tutorials/tools) - Explora este tutorial para aprender a trabajar efectivamente con herramientas.
- [Documentaci√≥n de Herramientas](https://huggingface.co/docs/smolagents/v1.8.1/en/reference/tools) - Documentaci√≥n de referencia completa sobre herramientas.
- [Tour Guiado de Herramientas](https://huggingface.co/docs/smolagents/v1.8.1/en/guided_tour#tools) - Un tour guiado paso a paso para ayudarte a construir y utilizar herramientas eficientemente.
- [Construyendo Agentes Efectivos](https://huggingface.co/docs/smolagents/tutorials/building_good_agents) - Una gu√≠a detallada sobre mejores pr√°cticas para desarrollar agentes de funci√≥n personalizados fiables y de alto rendimiento.